// Code generated by https://github.com/zhufuyi/sponge

package handler

import (
	"context"
	"user/internal/ecode"

	userV1 "user/api/user/v1"

	//"github.com/zhufuyi/sponge/pkg/gin/middleware"
	"github.com/zhufuyi/sponge/pkg/grpc/interceptor"
	"github.com/zhufuyi/sponge/pkg/logger"
)

var _ userV1.UserLogicer = (*userHandler)(nil)

type userHandler struct {
	// example:
	// 	userDao dao.UserDao
}

// NewUserHandler create a handler
func NewUserHandler() userV1.UserLogicer {
	return &userHandler{
		// example:
		// 	userDao: dao.NewUserDao(
		// 		model.GetDB(),
		// 		cache.NewUserCache(model.GetCacheType()),
		// 	),
	}
}

// Register ......
func (h *userHandler) Register(ctx context.Context, req *userV1.RegisterRequest) (*userV1.RegisterReply, error) {
	err := req.Validate()
	if err != nil {
		logger.Warn("req.Validate error", logger.Err(err), logger.Any("req", req), interceptor.ServerCtxRequestIDField(ctx))
		return nil, ecode.InvalidParams.Err()
	}

	// fill in the business logic code here

	return &userV1.RegisterReply{Id: 1}, err
}

// Login ......
func (h *userHandler) Login(ctx context.Context, req *userV1.LoginRequest) (*userV1.LoginReply, error) {
	err := req.Validate()
	if err != nil {
		logger.Warn("req.Validate error", logger.Err(err), logger.Any("req", req), interceptor.ServerCtxRequestIDField(ctx))
		return nil, ecode.InvalidParams.Err()
	}

	// fill in the business logic code here

	return &userV1.LoginReply{
		Id:    1,
		Token: "abcd......",
	}, nil
}

// Logout ......
func (h *userHandler) Logout(ctx context.Context, req *userV1.LogoutRequest) (*userV1.LogoutReply, error) {
	err := req.Validate()
	if err != nil {
		logger.Warn("req.Validate error", logger.Err(err), logger.Any("req", req), interceptor.ServerCtxRequestIDField(ctx))
		return nil, ecode.InvalidParams.Err()
	}

	// fill in the business logic code here

	return &userV1.LogoutReply{}, nil
}
